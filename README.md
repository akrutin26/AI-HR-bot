# AI-HR-bot

AI-HR-bot — это проект для автоматизации HR-процессов с использованием ИИ, предназначенный для анализа резюме, проведения голосовых собеседований и генерации отчётов с рекомендациями. Проект использует современные технологии, такие как DeepSpeed, для оптимизации работы моделей на GPU, и ориентирован на пользователей с высокопроизводительными видеокартами NVIDIA RTX. Разработан для трека AI HR хакатона MORE.Tech 2025.

## Требования к системе

### Программное обеспечение
- **Python**: версия 3.11.8 (обязательно)
- **CUDA**: версия 12.1 или выше
- **Операционная система**: Windows 10/11 (64-bit)

### Аппаратное обеспечение
- **Видеокарта**: NVIDIA RTX серии с поддержкой CUDA
- **Объем видеопамяти**: не менее 8 ГБ VRAM
- **Оперативная память**: не менее 16 ГБ RAM

### Протестированные конфигурации
- **Видеокарта**: NVIDIA RTX 3060 Ti 8GB (основная тестовая платформа)
- **CUDA**: версия 12.1
- **ОС**: Windows 11
- **Оперативная память**: 32 ГБ RAM

## Установка и настройка

Следуйте приведенным ниже шагам для установки и настройки проекта.

### 1. Клонирование репозитория
Склонируйте репозиторий проекта с GitHub и перейдите в директорию проекта:
```bash
git clone https://github.com/akrutin26/AI-HR-bot
cd AI-HR-bot
```

### 2. Распаковка весов модели TTS
Скачайте архив с весами модели TTS по ссылке: [https://disk.360.yandex.ru/d/R30J4AFeBsW6aA](https://disk.360.yandex.ru/d/R30J4AFeBsW6aA).  
Распакуйте содержимое архива в корневую директорию проекта. Это создаст папку с весами модели (например, `tts/tts_models--multilingual--multi-dataset--xtts_v2/`), необходимую для работы TTS (XTTS v2). Убедитесь, что путь к весам в коде (`main.py`) соответствует: `checkpoint_dir="tts/tts_models--multilingual--multi-dataset--xtts_v2/"` (относительно скрипта).

### 3. Создание виртуального окружения
Создайте виртуальное окружение для изоляции зависимостей проекта:
```bash
py -3.11 -m venv myenv311
```

### 4. Активация виртуального окружения
Активируйте виртуальное окружение в зависимости от вашей операционной системы:
- **Для Windows**:
  ```bash
  .\myenv311\Scripts\activate
  ```
- **Для Linux/MacOS**:
  ```bash
  source myenv311/bin/activate
  ```

### 5. Установка зависимостей
Установите все необходимые зависимости, указанные в файле `requirements.txt`:
```bash
pip install -r requirements.txt --extra-index-url https://download.pytorch.org/whl/cu121
```

### 6. Установка DeepSpeed
Установите DeepSpeed для оптимизации работы с моделями на GPU:
```bash
pip install deepspeed-0.15.0-cp311-cp311-win_amd64.whl
```
Убедитесь, что версия DeepSpeed соответствует вашей версии Python (3.11.8) и операционной системе.

### 7. Настройка переменных окружения
Создайте файл `.env` в корневой директории проекта и добавьте ваш API-ключ для работы с языковой моделью:
```plaintext
OPENAI_API_KEY="your_actual_PROXYAPI!!!_api_key_here"
```
Замените `your_actual_PROXYAPI!!!_api_key_here` на ваш реальный API-ключ.

### 8. Запуск приложения
Запустите приложение с помощью Uvicorn:
```bash
uvicorn main:app --reload
```
Флаг `--reload` позволяет автоматически перезапускать сервер при изменении исходного кода, что удобно для разработки.

## Использование

После успешного запуска приложение будет доступно по адресу `http://127.0.0.1:8000`. Вы можете взаимодействовать с API или интерфейсом приложения для анализа резюме, проведения собеседований и генерации отчётов.

- **Админ-панель**: `/admin` — управление вакансиями (требования, вопросы, веса критериев).
- **Собеседование**: `/ws?vacancy=junior` (или другой ключ) — голосовой чат с ИИ.
- **Архив отчётов**: `/archive` — просмотр и анализ собеседований.
- **Анализ резюме**: `/analyze` — загрузка и сравнение резюме с вакансией.

## Соответствие ТЗ MORE.Tech 2025 (Трек AI HR)

Проект полностью соответствует требованиям ТЗ трека AI HR хакатона MORE.Tech 2025 ([https://moretech.vtb.ru/ai-hr](https://moretech.vtb.ru/ai-hr)). ТЗ фокусируется на автоматизации HR: анализ резюме, голосовые собеседования, оценка кандидатов, отчёты и рекомендации. Ниже чек-лист с описанием реализации.

### 1. Анализ резюме и отбор кандидатов
**Требование ТЗ**: Автоматический скрининг резюме, сопоставление с требованиями вакансии, выявление ключевых навыков, пробелов и красных флагов. Количественная оценка (процент соответствия).

**Реализация**:
- **Эндпоинт**: POST `/api/resume/analyze` (интегрирован в `/analyze`).
- **Извлечение текста**: Поддержка TXT, PDF, DOC, DOCX через `PyPDF2`, `python-docx`, `pdfplumber`. Текст извлекается и очищается от артефактов.
- **LLM-анализ**: Промпт `resume_analysis_prompt_template` (ChatOpenAI GPT-4o-mini) сопоставляет резюме с требованиями вакансии, используя ключевые фразы, стаж, навыки. Учитывает веса критериев (`criteria_weights`, например, `{"technical_skills": 50, "communication": 30, "cases": 20}`).
- **Вывод**: Развёрнутый JSON:
  - `match_percentage`: Процент соответствия (0-100%).
  - `key_skills_from_resume`: Массив навыков (например, `["Python", "Django"]`).
  - `experience_summary`: Стаж и образование (например, "Стаж: 3 года, образование: МГУ").
  - `confirmed_skills`/`unconfirmed_skills`: Подтверждённые/неподтверждённые навыки с примерами.
  - `red_flags`: Проблемы (например, "Пробел в опыте 2020-2022").
  - `competencies_breakdown`: Сильные стороны, пробелы, советы по улучшению.
  - `recommendation`: "на следующий этап" (>70%), "отказ" (<50%), "требуется уточнение".
  - `notification_text`: Персонализированный отзыв (2-4 предложения).
- **Интерфейс**: Страница `/analyze` с формой (загрузка файла, выбор вакансии из `/api/vacancies`), спиннером ("Анализ в процессе...") и выводом результата в двухколоночном grid с цветами (зелёный для процента, красный для флагов).
- **Статус**: ✅ Полностью реализовано. Тестировано на реальных резюме, обработка markdown-обёрток (````json`) исправлена.

### 2. Голосовые собеседования
**Требование ТЗ**: Реальное время голосового взаимодействия, адаптивные вопросы на основе ответов, фиксация эмоций, пауз, структуры речи для soft skills. Профессиональный стиль ИИ.

**Реализация**:
- **Эндпоинт**: WebSocket `/ws?vacancy={key}` (например, `junior`).
- **ASR/TTS**: `faster_whisper` (large-v3, beam_size=5) для распознавания речи (многоязычное, включая русский). `XTTS v2` для синтеза (голос "Luis Moray", стриминг чанками).
- **Адаптация**: LLM (`prompt_template`, GPT-4o-mini) генерирует вопросы на основе истории чата, требований, вопросов и скрипта вакансии. Учитывает:
  - Эмоции (`predict_emotion` с Hubert: neutral/angry/positive/sad/other).
  - Структуру ответа (`analyze_structure` с LLM: логичность, связность).
  - Паузы (`analyze_pauses` с librosa: общая/средняя длительность, интерпретация уверенности).
- **Soft skills**: Эмоции, структура, паузы фиксируются в отчёте (`reports/{id}.json`) и влияют на вопросы (например, длинные паузы >5 сек → наводящий вопрос).
- **Стиль**: Промпт настроен на "профессиональный, дружелюбный, поддерживающий" стиль, избегающий канцеляризмов.
- **Интерфейс**: Голосовой чат через WebSocket (аудио/текст в реальном времени). Приветствие, цикл вопросов, завершение по `end_interview`.
- **Статус**: ✅ Полностью реализовано. Тестировано: паузы >5 сек вызывают адаптацию вопросов, эмоции/структура отображаются в отчёте.

### 3. Оценка кандидатов
**Требование ТЗ**: Количественная оценка (процент с весами), выявление сильных/слабых сторон, красных флагов, рекомендации. Учёт soft skills.

**Реализация**:
- **Чат**: `internal_analysis` (в `generate_and_analyze_response`) для каждого ответа: процент по весам (`criteria_weights`), подтверждённые/неподтверждённые навыки, флаги (уклонение, противоречия в стаже). Сохранение в `dialogue`.
- **Финальная оценка**: `/api/reports/{id}/generate` (`final_report_prompt_template`): агрегированный процент, разбивка по компетенциям, рекомендация ("на следующий этап"/"отказ"/"требуется уточнение"), уведомление.
- **Soft skills**: Эмоции (Hubert), структура (LLM), паузы (librosa) — всё в отчёте, влияет на адаптацию вопросов.
- **Интерфейс**: `/archive` показывает диалог, анализ (включая паузы: "Общая длительность: X.XX сек"), финальный отчёт с цветами (красный для флагов).
- **Статус**: ✅ Полностью реализовано. Процент настраивается в `/admin`, рекомендации обоснованы LLM.

### 4. Генерация отчётов и уведомлений
**Требование ТЗ**: Отчёты с процентом, разбивкой, рекомендацией. Персонализированная обратная связь (уведомления).

**Реализация**:
- **Отчёты**: JSON в `reports/{id}.json` (диалог, анализ, финал). `/archive` отображает с цветами (зелёный/процент, красный/флаги).
- **Уведомления**: `mailto` в `/archive` — предзаполняет письмо с `notification_text` (открывает почтовый клиент). Текст персонализирован (например, "Углубите SQL").
- **Интерфейс**: Кнопка "Отправить отзыв" в отчёте (email + `notification_text`).
- **Статус**: ✅ Полностью реализовано. Уведомления просты (mailto), тестированы в Gmail/Outlook.

### 5. Интерфейс и управление
**Требование ТЗ**: Прозрачный UI для HR (управление вакансиями, отчёты, анализ резюме).

**Реализация**:
- **Админ-панель**: `/admin` — CRUD вакансий (ключ, название, требования, вопросы, скрипт, `criteria_weights`).
- **Архив**: `/archive` — список отчётов, диалог, анализ (эмоции, паузы, структура), финальный отчёт, уведомления.
- **Анализ резюме**: `/analyze` — отдельная страница с формой (файл, выбор вакансии), спиннером ("Анализ в процессе..."), развёрнутым выводом (навыки, флаги, советы).
- **UI**: Tailwind CSS, единый стиль (синий/зелёный для ассистента/кандидата, красный для флагов).
- **Статус**: ✅ Полностью реализовано. UX удобный, индикаторы загрузки.

### 6. Технические требования
**Требование ТЗ**: Современные технологии (NLP, голос, LLM), Git, Яндекс Диск для демо.

**Реализация**:
- **Технологии**:
  - NLP: ChatOpenAI (GPT-4o-mini) для анализа резюме/ответов.
  - Голос: `faster_whisper` (ASR), `XTTS v2` (TTS), `Hubert` (эмоции).
  - Паузы: `librosa` (анализ тишины).
  - Бэкенд: FastAPI (WebSocket, REST).
- **Git**: Репозиторий на GitHub ([https://github.com/akrutin26/AI-HR-bot](https://github.com/akrutin26/AI-HR-bot)).
- **Яндекс Диск**: Веса TTS: [https://disk.360.yandex.ru/d/R30J4AFeBsW6aA](https://disk.360.yandex.ru/d/R30J4AFeBsW6aA). Демо/архив загружаются отдельно.
- **Статус**: ✅ Полностью реализовано.


### Видео-демо 
- **Ссылка**: [Видео-демо на Яндекс Диске](https://disk.360.yandex.ru/i/95GQpwbCbVQ3BA)

### Презентация (PDF)
- **Ссылка**: [Презентация PDF на Яндекс Диске](https://disk.360.yandex.ru/i/-CMFBXTyOe4Wrg)

### Ссылка на скачивание полного проекта
- **Ссылка**: [Полный проект на Яндекс Диске (без venv)](https://disk.360.yandex.ru/d/yfMorkklpsbPUQ)

## Дополнительные замечания
- Убедитесь, что драйверы вашей видеокарты NVIDIA обновлены до последней версии, совместимой с CUDA 12.1.
- Для повышения производительности рекомендуется использовать SSD для хранения проекта и временных файлов.
- Если возникают ошибки при установке DeepSpeed, проверьте совместимость версии Python, CUDA, PyTorch.
- Проект протестирован на Windows 10 с RTX 3060 Ti; для Linux/MacOS адаптируйте пути (например, `source myenv311/bin/activate`).

## ToDo (развитие проекта (было запланировано изначально, но времени не хватило))
- Добавить сессии пользователей, аутентификации и пр.
- Разделение прав пользователей.
- Улучшение UX/UI.
- Разделение SourceCode на модули.

## Контакты
Если у вас есть вопросы или предложения, свяжитесь с автором проекта:
- GitHub: [akrutin26](https://github.com/akrutin26)
- Email: akrutin26@gmail.com

## Лицензия и использование

Данный проект распространяется **исключительно для ознакомительных и некоммерческих целей**.  
Копирование, распространение, модификация и использование материалов проекта в коммерческих целях **запрещены** без письменного согласия автора.  

Все права защищены © Крутин Андрей Сергеевич, 2025.
